<html>
<head>
  <title>Book catalogue</title>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  <script src="http://code.highcharts.com/highcharts.js"></script>
</head>
<body>
  <h1>Books in catalogue</h1>
  {% if latest_book_list %}
    <ul>
      {% for book in latest_book_list %}
        <li><a href='{% url 'book_detail' book.id %}'>{{ book.title }}</a></li>
      {% endfor %}
    </ul>
  {% else %}
    <p>No books are available.</p>
  {% endif %}

  <div id="container" style="width: 550px; height: 400px; margin: 0 auto"></div>
  <script language="JavaScript">
    
    $(document).ready(function() {

      var title = {
        text: 'Books by Publisher'   
      };
      
      var series = [{
        type: 'pie',
        name: 'books per.',
        data: [
          
          {% for publisher, book_count in book_by_publisher_piechart_data %}
            ['{{ publisher|safe }}', {{ book_count|safe }}],
          {% endfor %}
          
        ]
      }];
      
      var tooltip = {
        pointFormat: '{series.name}: <b>{point.y:.1f}</b>'
      };
      
      var plotOptions = {
        pie: {
          dataLabels: {
            enabled: true,
            format: '<b>{point.name}</b>: {point.percentage:.1f} %'
          },
          showInLegend: false
        }
      };

      var credits = {
        enabled: false
      };

      var json = {};

      json.title = title;
      json.series = series;
      json.tooltip = tooltip;
      json.plotOptions = plotOptions;
      json.credits = credits;

      $('#container').highcharts(json)
    });
  </script>
</body>
</html>